<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Brighter Minds</title>

  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <!-- Vue 2 -->
  <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
</head>
<body>
  <div id="app" class="container mt-4">
    <!-- Header -->
    <header class="d-flex justify-content-between align-items-center mb-4">
      <div>
        <h1 class="fw-bold text-primary">{{ sitename }}</h1>
        <p class="text-muted fst-italic">{{ ssitename }}</p>
      </div>
      <button class="btn btn-warning" @click="toggleCart" :disabled="cart.length === 0">
        {{ cart.length }} <i class="fa-solid fa-cart-shopping ms-1"></i> Checkout
      </button>
    </header>

    <!-- LESSONS PAGE -->
    <section v-if="!showCart" class="row justify-content-end">
      <div class="col-lg-10">

        <!-- Filters -->
        <div class="d-flex flex-wrap mb-4 align-items-center">
          <input v-model="searchQuery" @input="searchLessons"
            type="text" placeholder="Search lessons"
            class="form-control me-2 mb-2" style="max-width: 250px;" />

          <select v-model="sortBy" class="form-select me-2 mb-2" style="width: 200px;">
            <option value="subject">Subject</option>
            <option value="location">Location</option>
            <option value="price">Price</option>
            <option value="spaces">Spaces</option>
          </select>

          <button class="btn btn-secondary mb-2" @click="sortOrder *= -1">
            Sort: {{ sortOrder === 1 ? 'Asc' : 'Desc' }}
          </button>
        </div>

        <!-- Lessons list -->
        <div class="row row-cols-1 row-cols-md-2 g-4">
          <div v-for="lesson in sortedLessons" :key="lesson.id" class="col">
            <div class="card h-100 border-info shadow-sm">
              <div class="card-body">
                <h5 class="card-title">
                  <i :class="['fa-solid', lesson.icon]" class="me-2 text-info"></i>
                  {{ lesson.subject }}
                </h5>
                <p class="card-text"><strong>Location:</strong> {{ lesson.location }}</p>
                <p class="card-text"><strong>Price:</strong> Â£{{ lesson.price }}</p>
                <p class="card-text"><strong>Spaces:</strong> {{ lesson.spaces }}</p>
              </div>
              <div class="card-footer bg-white border-top-0">
                <button class="btn btn-primary w-100"
                  :disabled="lesson.spaces === 0"
                  @click="addToCart(lesson)">
                  Add to Cart
                </button>
              </div>
            </div>
          </div>
        </div>

      </div>
    </section>

    <!-- CART PAGE -->
    <section v-else class="mt-4">
      <h2 class="mb-3">ðŸ›’ Shopping Cart</h2>

      <div v-if="cart.length > 0" class="list-group mb-4">
        <div v-for="(item, index) in cart" :key="index"
          class="list-group-item d-flex justify-content-between align-items-center">
          {{ item.subject }} - {{ item.location }}
          <button class="btn btn-sm btn-danger" @click="removeFromCart(item)">
            Remove
          </button>
        </div>
      </div>
      <div v-else class="alert alert-info">Your cart is empty.</div>

      <!-- Checkout Form -->
      <form @submit.prevent="checkout" class="bg-light p-4 rounded shadow-sm" style="max-width: 400px;">
        <h4 class="mb-3">Checkout Form</h4>
        <div class="mb-3">
          <label class="form-label">Name</label>
          <input
            v-model="name"
            type="text"
            class="form-control"
            placeholder="Letters only"
            required
            pattern="[A-Za-z\s]+"
            title="Name must contain letters only"
          />
        </div>
        <div class="mb-3">
          <label class="form-label">Phone</label>
          <input
            v-model="phone"
            type="text"
            class="form-control"
            placeholder="Numbers only"
            required
            pattern="\d+"
            title="Phone must contain numbers only"
          />
        </div>
        <button type="submit" class="btn btn-success w-100" :disabled="!validForm">
          Confirm Order
        </button>
      </form>
    </section>
  </div>

  <!-- Vue App -->
  <script>
    new Vue({
      el: '#app',
      data: {
        sitename: "Brighter Minds",
        ssitename: "After School Enrichment for Curious Learners",
        lessons: [
          { id: 1, subject: "Math", location: "London", price: 100, spaces: 5, icon: "fa-calculator" },
          { id: 2, subject: "Biology", location: "Manchester", price: 80, spaces: 3, icon: "fa-dna" },
          { id: 3, subject: "English", location: "Leeds", price: 90, spaces: 5, icon: "fa-book" },
          { id: 4, subject: "Physics", location: "Bristol", price: 120, spaces: 4, icon: "fa-atom" },
          { id: 5, subject: "Chemistry", location: "Birmingham", price: 110, spaces: 5, icon: "fa-flask" },
          { id: 6, subject: "History", location: "Oxford", price: 70, spaces: 5, icon: "fa-landmark" },
          { id: 7, subject: "Geography", location: "Cambridge", price: 75, spaces: 5, icon: "fa-globe" },
          { id: 8, subject: "Art", location: "Liverpool", price: 60, spaces: 5, icon: "fa-paintbrush" },
          { id: 9, subject: "Music", location: "Edinburgh", price: 85, spaces: 5, icon: "fa-music" },
          { id: 10, subject: "Computer Science", location: "London", price: 130, spaces: 5, icon: "fa-laptop-code" },
        ],
        cart: [],
        showCart: false,
        name: '',
        phone: '',
        sortBy: 'subject',
        sortOrder: 1,
        searchQuery: ''
      },
      computed: {
        sortedLessons() {
          let filtered = this.lessons.filter(lesson => {
            const term = this.searchQuery.toLowerCase();
            return (
              lesson.subject.toLowerCase().includes(term) ||
              lesson.location.toLowerCase().includes(term) ||
              lesson.price.toString().includes(term) ||
              lesson.spaces.toString().includes(term)
            );
          });

          return filtered.sort((a, b) => {
            let x = a[this.sortBy];
            let y = b[this.sortBy];

            if (typeof x === 'string') {
              x = x.toLowerCase();
              y = y.toLowerCase();
            }

            return (x > y ? 1 : x < y ? -1 : 0) * this.sortOrder;
          });
        },
        validForm() {
          const nameValid = /^[A-Za-z\s]+$/.test(this.name);
          const phoneValid = /^\d+$/.test(this.phone);
          return nameValid && phoneValid && this.cart.length > 0;
        }
      },
      methods: {
        toggleCart() {
          this.showCart = !this.showCart;
        },
        addToCart(lesson) {
          if (lesson.spaces > 0) {
            this.cart.push(lesson);
            lesson.spaces--;
          }
        },
        removeFromCart(lesson) {
          const index = this.cart.indexOf(lesson);
          if (index !== -1) {
            this.cart.splice(index, 1);
            lesson.spaces++;
          }
        },
        checkout() {
          alert(`Order confirmed for ${this.name}. Thank you!`);
          this.cart = [];
          this.name = '';
          this.phone = '';
          this.showCart = false;
        },
        searchLessons() {
          // Reactive via computed
        }
      }
    });
  </script>

  <!-- Bootstrap 5 JS (optional, for dropdowns, etc.) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
